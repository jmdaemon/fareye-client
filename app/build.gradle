plugins {
    id 'application'
    id 'checkstyle'
    id 'org.openjfx.javafxplugin' version '0.0.10'
    //id 'com.github.johnrengelman.shadow' version '7.1.2'
}

group = 'io.github.jmdaemon'
version = '0.1.0'

//def AppEntryPoint = 'app.ui.javafx.App'
//def AppEntryPoint = 'app.ui.jfx.App'
def AppEntryPoint = 'jfx.App'
//def AppEntryPoint = 'ui.jfx.App'

// Set custom source sets to compile certain files in certain directories only

//ext {
    //src = "src/main/java"
    //org = group
    //test = "src/test/java"
//}

//sourceSets.all { 
    //ext.src = src
    //ext.test = test
//}

repositories {
    mavenCentral()
    // Add jars in app/libs
    flatDir {
        dirs 'libs'
    }
}

dependencies {
    implementation 'com.google.guava:guava:31.1-jre'
    // Unit Testing

    // Test Framework

    //testImplementation (platform('org.junit:junit-bom:5.7.0'))
    //testImplementation 'org.junit.jupiter:junit-jupiter-api:5.7.0'
    //testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.7.0'
    //testRuntimeOnly "org.junit.platform:junit-platform-launcher:1.7.0"

    // Mocking
    testImplementation("org.mock-server:mockserver-netty:5.11.2")

    // Logging
    implementation 'org.unix4j:unix4j-command:0.5'

    // Graphics

    // Icons

    //implementation platform('org.kordamp.ikonli:ikonli-bom:12.1.0')
    //implementation 'org.kordamp.ikonli:ikonli-core'
    //implementation 'org.kordamp.ikonli:ikonli-javafx'
    //implementation 'org.kordamp.ikonli:ikonli-fontawesome5-pack:12.0.0'
    //implementation 'org.kordamp.ikonli:ikonli-boxicons-pack:12.0.0'

    // My Custom Dependencies
    implementation 'io.github.jmdaemon:toolbox:0.1.2'
    implementation 'io.github.jmdaemon:crypt:0.1.0'
}

testing {
    suites {
        // Configure the built-in test suite
        test {
            // Use JUnit Jupiter test framework
            useJUnitJupiter('5.8.1')
        }
    }
} 

test {
    maxHeapSize = '1G'
    //useJUnitPlatform()
    testLogging {
        events "failed"
        exceptionFormat "full"
        showStandardStreams = true
    }
}

java {
    toolchain {
        //languageVersion = JavaLanguageVersion.of(17)
        languageVersion = JavaLanguageVersion.of(18)
    }
    //moularity.inferModulePath = true
}

javafx {
    version = "17.0.1"
    //version = "18.0.1"
    modules = [ 'javafx.base', 'javafx.graphics', 'javafx.controls' , 'javafx.fxml' ]
}

application {
    mainClass = AppEntryPoint
}

//shadowJar {
    // https://stackoverflow.com/questions/32887966/shadow-plugin-gradle-what-does-mergeservicefiles-do
    //mergeServiceFiles()
//}


checkstyle { 
    toolVersion = "10.0"
    configFile file("config/checkstyle/sun_checks.xml") 
    // Disable checkstyle checks for now
    checkstyleMain.enabled = false
    checkstyleTest.enabled = false
}

sourceSets {
    //ext {
    //src = "src/main/java"
    //test = "src/test/java"
    //}
    main {
        resources {
            includes = [ "**/*.fxml" , "**/*.css" , "**/*.properties"]
            //srcDirs = [ "$src" ]
            //exclude "$src/bankaccount"
            //exclude "$src/interface-old"
            //exclude "$src/money"

            exclude "bankaccount"
            exclude "interface-old"
            exclude "money"
        }
        //src`
        java {
            //srcDirs = [ "$src/ui" ]
            //srcDirs = [ "$src/fareye", "$src/ui/javafx", "$src/ui/javafx/events", "$src/ui/javafx/controllers"]
            //srcDirs = [ "$src/fareye", "$src/ui", "$src/ui/javafx", "$src/ui/javafx/controllers"]
            //srcDirs = [ "$src/fareye", "$src/ui", "$src/ui/jfx", "$src/ui/jfx/controllers" ]
            //exclude = [ "$src/bankaccount", "$src/interface-old", "$src/money" ]
            //srcDirs = [ "$src" ]
            //srcDirs = [ "$src/fareye", "$src/ui" ]

            //exclude "$src/bankaccount"
            //exclude "$src/interface-old"
            //exclude "$src/money"
            //srcDirs = [ "$src/fareye", "$src/ui" ]

            exclude "bankaccount"
            exclude "interface-old"
            exclude "money"
         }
    }
    test {
        java {
            //srcDirs = [ "$test/ui" ]
            //srcDirs = [ "$src/fareye", "$test/ui/javafx" ]
            //srcDirs = [ "$test/fareye" ]
            //exclude [ "$src/bankaccount", "$src/connect", "$src/encryption", "$src/interface", "$src/money", "$src/old", "$src/ui" ]
            //exclude = [ "$src/bankaccount", "$src/connect", "$src/encryption", "$src/interface", "$src/money", "$src/old", "$src/ui" ]

            //srcDirs = [ "$test" ]
            //exclude "$test/bankaccount"
            //exclude "$test/connect"
            //exclude "$test/encryption"
            //exclude "$test/interface"
            //exclude "$test/money"
            //exclude "$test/old"
            //exclude "$test/ui"

            exclude "bankaccount"
            exclude "connect"
            exclude "encryption"
            exclude "interface"
            exclude "money"
            exclude "old"
            exclude "ui"

        }
    }
}
